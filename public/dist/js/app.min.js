angular.module("flapperNews",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("home",{url:"/home",templateUrl:"/views/home.html",controller:"MainCtrl",resolve:{postPromise:["$posts",function(a){return a.getAll()}]}}).state("posts",{url:"/posts/{id}",templateUrl:"/views/posts.html",controller:"PostsCtrl"}),b.otherwise("home")}]),angular.module("flapperNews").controller("MainCtrl",["$scope","$posts",function(a,b){a.posts=b.posts,a.addPost=function(){a.title&&""!==a.title&&(b.create({title:a.title,link:a.link}),a.title="",a.link="")},a.incrementUpvotes=function(a){b.upvote(a)}}]),angular.module("flapperNews").controller("PostsCtrl",["$scope","$stateParams","$posts",function(a,b,c){a.post=c.posts[b.id],a.addComment=function(){""!==a.body&&(a.post.comments.push({body:a.body,author:"user",upvotes:0}),a.body="")}}]),angular.module("flapperNews").service("$api",["$http",function(a){var b=function(b,c,d){return a.request=a[d]("http://localhost:3000"+b,c),a.request};return{get:function(a,c){return b(a,{params:c},"get")},post:function(a,c){return b(a,c,"post")},"delete":function(a,c){return b(a,{params:c},"delete")},put:function(a,c){return b(a,{params:c},"put")}}}]),angular.module("flapperNews").factory("$posts",["$api",function(a){var b={posts:[]};return b.getAll=function(){return a.get("/posts").success(function(a){angular.copy(a,b.posts)})},b.create=function(c){return a.post("/posts",c).success(function(a){b.posts.push(a)})},b.upvote=function(b){return a.put("/posts/"+b._id+"/upvote").success(function(a){b.upvotes+=1})},b}]);