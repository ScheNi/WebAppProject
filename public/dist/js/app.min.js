angular.module("flapperNews",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("home",{url:"/home",templateUrl:"/views/home.html",controller:"MainCtrl",resolve:{postPromise:["$posts",function(a){return a.getAll()}]}}).state("posts",{url:"/posts/{id}",templateUrl:"/views/posts.html",controller:"PostsCtrl",resolve:{post:["$stateParams","$posts",function(a,b){return b.get(a.id)}]}}),b.otherwise("home")}]),angular.module("flapperNews").controller("MainCtrl",["$scope","$posts",function(a,b){a.posts=b.posts,a.addPost=function(){a.title&&""!==a.title&&(b.create({title:a.title,link:a.link}),a.title="",a.link="")},a.incrementUpvotes=function(a){b.upvote(a)}}]),angular.module("flapperNews").controller("PostsCtrl",["$scope","$posts","post",function(a,b,c){a.post=c,a.addComment=function(){""!==a.body&&(b.addComment(c._id,{body:a.body,author:"user"}).success(function(b){a.post.comments.push(b)}),a.body="")},a.incrementUpvotes=function(a){b.upvoteComment(c,a)}}]),angular.module("flapperNews").service("$api",["$http",function(a){var b=function(b,c,d){return a.request=a[d]("http://localhost:3000"+b,c),a.request};return{get:function(a,c){return b(a,{params:c},"get")},post:function(a,c){return b(a,c,"post")},"delete":function(a,c){return b(a,{params:c},"delete")},put:function(a,c){return b(a,{params:c},"put")}}}]),angular.module("flapperNews").factory("$posts",["$api",function(a){var b={posts:[]};return b.getAll=function(){return a.get("/posts").success(function(a){angular.copy(a,b.posts)})},b.create=function(c){return a.post("/posts",c).success(function(a){b.posts.push(a)})},b.upvote=function(b){return a.put("/posts/"+b._id+"/upvote").success(function(a){b.upvotes+=1})},b.get=function(b){return a.get("/posts/"+b).then(function(a){return a.data})},b.addComment=function(b,c){return a.post("/posts/"+b+"/comments",c)},b.upvoteComment=function(b,c){return a.put("/posts/"+b._id+"/comments/"+c._id+"/upvote").success(function(a){c.upvotes+=1})},b}]);